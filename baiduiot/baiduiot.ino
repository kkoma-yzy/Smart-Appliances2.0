#include <ESP8266WiFi.h>
#include <PubSubClient.h>
#include <DHT.h>
#include <ArduinoJson.h>
#include <IRremoteESP8266.h>
#include <IRsend.h>
int num;
DHT sensor(D5,DHT11);
IRsend remote(D1);
uint16_t poweron[199] = {4452, 4542,  566, 1630,  590, 562,  564, 1620,  590, 1656,  566, 538,  614, 534,  564, 1626,  614, 542,  588, 520,  614, 1632,  588, 512,  614, 540,  588, 1602,  614, 1630,  588, 512,  614, 1628,  588, 1606,  616, 540,  588, 1602,  616, 1628,  588, 1606,  614, 1630,  588, 1602,  614, 1628,  588, 512,  614, 1628,  590, 490,  636, 542,  586, 514,  614, 540,  588, 514,  612, 542,  586, 1606,  614, 1632,  586, 1606,  612, 544,  586, 512,  612, 1642,  586, 520,  612, 542,  584, 516,  612, 534,  586, 512,  610, 1634,  584, 1608,  610, 542,  584, 1612,  610, 1632,  584, 5236,  4486, 4500,  580, 1610,  606, 546,  580, 1608,  606, 1636,  580, 522,  606, 550,  580, 1608,  604, 558,  578, 532,  604, 1652,  580, 526,  602, 556,  578, 1618,  604, 1638,  578, 526,  580, 1666,  578, 1608,  604, 550,  576, 1610,  580, 1670,  578, 1620,  578, 1668,  578, 1614,  604, 1646,  578, 522,  580, 1654,  596, 524,  602, 550,  576, 524,  580, 578,  552, 550,  578, 574,  554, 1634,  580, 1662,  554, 1634,  580, 572,  552, 546,  576, 1672,  552, 552,  578, 576,  552, 548,  578, 574,  552, 548,  578, 1664,  552, 1638,  578, 576,  552, 1636,  578, 1666,  552};  // COOLIX B2BFE4
//uint16_t poweroff[199] = {4452, 4546,  588, 1602,  616, 542,  586, 1604,  614, 1630,  588, 514,  616, 540,  588, 1602,  616, 542,  588, 514,  614, 1630,  588, 514,  614, 542,  586, 1604,  614, 1630,  588, 514,  614, 1630,  588, 518,  614, 1630,  588, 1606,  614, 1630,  588, 1606,  614, 542,  588, 1600,  612, 1632,  588, 1604,  616, 540,  586, 516,  612, 542,  586, 516,  612, 1632,  586, 516,  612, 544,  586, 1606,  612, 1632,  586, 1606,  612, 544,  584, 518,  610, 544,  584, 518,  610, 544,  584, 518,  610, 546,  582, 520,  608, 1636,  582, 1608,  606, 1640,  580, 1616,  604, 1646,  578, 5244,  4482, 4502,  554, 1642,  578, 582,  552, 1642,  578, 1670,  552, 554,  576, 582,  550, 1644,  576, 582,  550, 554,  574, 1674,  548, 556,  532, 624,  506, 1688,  534, 1716,  506, 598,  532, 1714,  506, 598,  534, 1714,  506, 1688,  534, 1714,  508, 1688,  532, 624,  506, 1688,  532, 1718,  506, 1688,  532, 626,  506, 598,  532, 624,  506, 600,  532, 1716,  506, 598,  532, 624,  506, 1688,  564, 1682,  540, 1658,  566, 594,  538, 566,  564, 592,  538, 566,  564, 592,  538, 568,  564, 592,  538, 566,  588, 1660,  538, 1656,  588, 1660,  562, 1636,  588, 1660,  562};  // COOLIX B27BE0
uint16_t poweroff[199] = {4550, 4432,  516, 1610,  514, 542,  516, 1608,  516, 1608,  516, 542,  516, 542,  516, 1608,  516, 542,  516, 542,  516, 1608,  516, 542,  514, 542,  516, 1608,  514, 1610,  514, 542,  514, 1608,  516, 542,  516, 1608,  516, 1608,  516, 1608,  514, 1610,  514, 542,  516, 1608,  514, 1610,  516, 1608,  514, 542,  514, 544,  514, 542,  514, 542,  516, 1608,  516, 542,  514, 542,  514, 1610,  514, 1610,  514, 1610,  514, 542,  514, 544,  514, 544,  514, 542,  514, 544,  514, 542,  514, 542,  516, 542,  516, 1608,  516, 1608,  516, 1608,  516, 1608,  516, 1608,  516, 5202,  4580, 4400,  516, 1608,  516, 542,  516, 1610,  514, 1608,  516, 542,  516, 542,  516, 1608,  516, 542,  516, 542,  514, 1610,  514, 544,  514, 542,  516, 1608,  516, 1608,  516, 542,  516, 1610,  514, 542,  516, 1608,  516, 1608,  516, 1610,  514, 1608,  516, 542,  514, 1608,  516, 1608,  516, 1610,  514, 542,  514, 544,  514, 542,  514, 542,  514, 1608,  516, 542,  514, 542,  516, 1608,  516, 1608,  516, 1608,  516, 542,  514, 542,  514, 544,  514, 544,  514, 542,  514, 542,  514, 544,  514, 544,  514, 1610,  514, 1610,  514, 1610,  514, 1612,  512, 1610,  514};  // COOLIX B27BE0
uint16_t temp[14][199] = {
                            {4580, 4402,  510, 1616,  510, 546,  510, 1614,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 1616,  508, 548,  508, 1614,  510, 548,  510, 548,  510, 548,  508, 1616,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 546,  512, 546,  510, 548,  510, 548,  510, 548,  510, 546,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 550,  508, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 1612,  510, 5206,  4580, 4402,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 548,  508, 1616,  510, 548,  510, 548,  508, 548,  508, 1614,  510, 1614,  508, 1614,  510, 1614,  510, 1614,  510, 1616,  508, 1614,  508, 1616,  510, 548,  508, 548,  510, 548,  508, 550,  508, 548,  510, 548,  508, 550,  508, 550,  508, 548,  508, 550,  508, 1616,  508, 550,  508, 550,  508, 1616,  508, 1616,  508, 1616,  508, 1616,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508},
                            {4580, 4402,  510, 1614,  510, 546,  512, 1614,  510, 1612,  512, 546,  510, 546,  510, 1614,  510, 546,  510, 546,  512, 1612,  512, 546,  510, 546,  510, 1614,  512, 1612,  510, 546,  512, 1612,  512, 546,  510, 546,  510, 546,  512, 1612,  512, 1612,  510, 1614,  512, 1612,  512, 1612,  510, 1614,  510, 1614,  510, 1614,  510, 548,  510, 546,  512, 546,  510, 546,  512, 546,  510, 546,  510, 546,  512, 546,  512, 1612,  512, 546,  510, 1614,  510, 546,  510, 546,  512, 1612,  512, 1612,  512, 1612,  512, 546,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 5206,  4578, 4404,  510, 1612,  512, 546,  512, 1612,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 548,  510, 548,  510, 548,  510, 548,  508, 548,  510, 1614,  510, 548,  508, 1616,  508, 548,  508, 548,  508, 1616,  508, 1614,  510, 1614,  510, 550,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508},
                            {4580, 4402,  512, 1612,  512, 546,  512, 1614,  510, 1612,  512, 546,  512, 546,  510, 1612,  512, 546,  510, 546,  510, 1614,  512, 546,  512, 548,  510, 1614,  510, 1614,  510, 546,  510, 1614,  510, 546,  512, 546,  510, 546,  512, 1614,  510, 1612,  512, 1614,  510, 1612,  512, 1612,  512, 1612,  512, 1614,  510, 1612,  512, 548,  510, 546,  512, 546,  510, 546,  510, 546,  512, 546,  512, 546,  510, 1614,  510, 1614,  510, 546,  510, 1612,  512, 546,  510, 546,  510, 1614,  510, 1612,  512, 546,  510, 546,  512, 1614,  510, 546,  512, 1612,  510, 1614,  510, 5204,  4580, 4402,  510, 1614,  512, 546,  510, 1612,  512, 1612,  512, 546,  510, 548,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  508, 548,  510, 548,  510, 548,  510, 548,  508, 548,  510, 548,  508, 1614,  510, 1614,  510, 548,  508, 1616,  510, 548,  508, 548,  510, 1614,  510, 1614,  508, 550,  508, 548,  508, 1614,  510, 548,  508, 1616,  508, 1616,  508},
                            {4580, 4402,  512, 1612,  510, 546,  512, 1612,  512, 1612,  512, 546,  510, 546,  510, 1614,  510, 546,  512, 546,  510, 1612,  512, 546,  510, 548,  510, 1612,  512, 1614,  510, 546,  512, 1612,  512, 546,  510, 546,  510, 546,  510, 1614,  512, 1612,  512, 1612,  512, 1612,  510, 1614,  512, 1612,  512, 1612,  510, 1614,  510, 546,  512, 546,  510, 546,  510, 546,  512, 546,  512, 546,  510, 546,  512, 1612,  512, 546,  510, 546,  510, 1614,  510, 546,  512, 546,  512, 1612,  512, 1612,  512, 546,  512, 1612,  510, 1614,  510, 546,  510, 1614,  510, 1614,  512, 5204,  4580, 4404,  510, 1612,  512, 546,  510, 1614,  510, 1614,  510, 546,  512, 546,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 548,  508, 548,  508, 548,  510, 548,  508, 548,  510, 1614,  508, 550,  508, 548,  510, 1614,  510, 548,  508, 548,  508, 1614,  510, 1616,  508, 548,  510, 1614,  510, 1614,  508, 550,  508, 1616,  508, 1616,  508},
                            {4582, 4400,  512, 1612,  512, 546,  510, 1614,  510, 1614,  510, 546,  510, 546,  512, 1612,  510, 546,  512, 546,  510, 1614,  510, 546,  510, 548,  510, 1612,  512, 1612,  512, 546,  510, 1614,  510, 546,  510, 546,  512, 546,  510, 1614,  512, 1612,  512, 1612,  512, 1612,  512, 1612,  512, 1614,  510, 1614,  512, 1612,  512, 546,  510, 546,  510, 546,  512, 546,  512, 546,  510, 546,  512, 1614,  510, 1612,  510, 546,  512, 546,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 546,  510, 546,  510, 1614,  510, 1612,  512, 546,  512, 1612,  510, 1614,  510, 5206,  4580, 4402,  510, 1614,  510, 546,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 548,  510, 1616,  508, 1614,  510, 1614,  510, 1616,  508, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  508, 548,  510, 550,  508, 548,  510, 550,  508, 548,  508, 1614,  510, 1614,  510, 548,  510, 548,  508, 1616,  508, 550,  508, 548,  508, 1616,  508, 548,  508, 550,  508, 1616,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508},
                            {4582, 4400,  512, 1612,  512, 546,  510, 1612,  510, 1614,  512, 546,  512, 546,  510, 1614,  510, 546,  510, 548,  510, 1612,  512, 546,  510, 546,  510, 1614,  512, 1612,  512, 546,  510, 1612,  512, 546,  510, 546,  512, 546,  510, 1614,  512, 1612,  512, 1612,  512, 1612,  512, 1612,  510, 1614,  510, 1614,  510, 1614,  510, 546,  512, 546,  512, 546,  510, 548,  510, 546,  510, 546,  510, 1612,  512, 1614,  510, 1612,  512, 548,  510, 1612,  510, 546,  512, 546,  510, 1614,  510, 546,  510, 546,  512, 546,  510, 1612,  512, 546,  510, 1614,  512, 1612,  510, 5204,  4580, 4402,  510, 1614,  510, 546,  510, 1614,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 546,  510, 548,  508, 1614,  510, 1614,  510, 548,  510, 1612,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  508, 548,  510, 548,  508, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  508, 550,  508, 1616,  508, 548,  508, 550,  508, 1616,  508, 550,  508, 550,  508, 550,  508, 1616,  510, 548,  508, 1616,  508, 1616,  508},
                            {4578, 4402,  512, 1612,  512, 546,  510, 1612,  512, 1612,  512, 546,  512, 546,  510, 1612,  512, 546,  510, 546,  510, 1612,  512, 546,  512, 546,  510, 1614,  510, 1614,  510, 546,  510, 1614,  510, 546,  510, 548,  510, 546,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1612,  512, 1614,  510, 1614,  510, 546,  510, 546,  510, 546,  512, 546,  510, 546,  510, 546,  512, 1612,  512, 546,  510, 1614,  510, 548,  510, 1614,  510, 546,  512, 546,  510, 1614,  510, 546,  510, 1612,  512, 546,  510, 1614,  510, 548,  510, 1612,  512, 1606,  518, 5206,  4580, 4402,  510, 1614,  510, 548,  510, 1612,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  508, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  508, 1616,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  508, 550,  508, 548,  508, 548,  510, 548,  508, 548,  508, 548,  508, 1616,  508, 550,  508, 1616,  508, 550,  508, 1616,  510, 548,  508, 548,  508, 1616,  508, 550,  508, 1616,  508, 550,  508, 1616,  508, 550,  508, 1614,  508, 1616,  508},
                            {4580, 4404,  510, 1614,  512, 546,  510, 1612,  512, 1612,  512, 546,  512, 546,  512, 1612,  512, 546,  510, 546,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 1614,  510, 546,  512, 1612,  512, 546,  510, 546,  512, 546,  510, 1612,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 546,  512, 546,  510, 546,  512, 546,  510, 546,  510, 546,  510, 1614,  510, 546,  512, 546,  510, 546,  510, 1614,  510, 546,  510, 548,  510, 1612,  512, 546,  512, 1612,  510, 1614,  510, 1612,  512, 546,  510, 1614,  512, 1612,  510, 5204,  4580, 4404,  510, 1612,  512, 546,  510, 1614,  512, 1612,  510, 546,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 1614,  510, 548,  508, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 548,  508, 548,  508, 548,  510, 548,  508, 1614,  510, 548,  508, 548,  510, 548,  508, 1614,  508, 550,  508, 548,  508, 1616,  508, 550,  508, 1616,  510, 1614,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508},
                            {4580, 4402,  512, 1612,  512, 546,  512, 1612,  510, 1614,  512, 546,  510, 546,  510, 1614,  510, 546,  512, 546,  512, 1612,  510, 546,  510, 548,  510, 1614,  510, 1614,  510, 546,  510, 1614,  510, 546,  512, 546,  512, 546,  512, 1614,  510, 1612,  512, 1614,  510, 1614,  510, 1614,  510, 1612,  512, 1612,  512, 1612,  512, 546,  512, 546,  510, 548,  510, 546,  510, 546,  512, 1612,  510, 1614,  510, 546,  512, 546,  512, 546,  510, 1614,  510, 546,  512, 546,  510, 546,  510, 546,  510, 1614,  512, 1612,  510, 1614,  510, 546,  510, 1614,  512, 1614,  510, 5208,  4578, 4402,  510, 1612,  512, 548,  510, 1614,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 548,  508, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  508, 548,  508, 548,  508, 550,  508, 550,  508, 1616,  508, 1614,  510, 548,  508, 548,  508, 550,  508, 1616,  508, 550,  508, 548,  508, 548,  508, 550,  508, 1616,  508, 1616,  508, 1616,  508, 550,  508, 1614,  510, 1616,  508},
                            {4580, 4402,  512, 1612,  510, 546,  512, 1614,  510, 1612,  512, 546,  510, 546,  512, 1614,  510, 546,  510, 548,  510, 1614,  510, 546,  510, 546,  510, 1614,  512, 1612,  512, 546,  510, 1612,  512, 546,  510, 546,  510, 548,  510, 1612,  512, 1612,  512, 1612,  510, 1614,  510, 1614,  512, 1612,  510, 1614,  510, 1614,  510, 546,  512, 546,  512, 546,  510, 546,  512, 546,  512, 1612,  512, 1612,  512, 546,  510, 1614,  510, 546,  512, 1612,  510, 546,  512, 548,  510, 546,  510, 546,  512, 1612,  512, 546,  512, 1612,  510, 546,  510, 1614,  510, 1614,  510, 5206,  4580, 4402,  510, 1612,  512, 546,  510, 1612,  512, 1614,  510, 546,  512, 546,  510, 1614,  510, 548,  510, 548,  510, 1612,  512, 546,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  508, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  508, 1616,  510, 1614,  510, 1616,  508, 548,  510, 548,  510, 548,  508, 548,  510, 548,  510, 1614,  510, 1614,  508, 550,  508, 1616,  510, 548,  508, 1616,  508, 550,  508, 548,  508, 550,  508, 548,  508, 1616,  508, 550,  508, 1616,  508, 550,  508, 1614,  508, 1616,  508},
                            {4580, 4402,  512, 1614,  510, 546,  512, 1612,  510, 1614,  510, 548,  510, 548,  510, 1612,  512, 546,  510, 546,  510, 1612,  512, 546,  512, 546,  510, 1614,  510, 1614,  510, 546,  510, 1614,  510, 546,  510, 548,  510, 546,  510, 1614,  510, 1614,  510, 1612,  512, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 546,  510, 546,  510, 548,  510, 546,  510, 546,  510, 1614,  510, 546,  512, 546,  512, 1612,  510, 546,  510, 1612,  512, 546,  512, 546,  512, 546,  510, 1614,  510, 1614,  510, 548,  510, 1612,  512, 546,  510, 1612,  512, 1614,  510, 5204,  4580, 4402,  512, 1612,  512, 546,  510, 1614,  510, 1612,  512, 546,  510, 546,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1616,  508, 1614,  510, 1614,  510, 548,  508, 548,  508, 548,  510, 548,  510, 548,  508, 1614,  510, 550,  508, 550,  508, 1614,  510, 548,  508, 1614,  510, 548,  508, 550,  508, 550,  508, 1616,  508, 1616,  508, 550,  508, 1616,  510, 548,  508, 1616,  508, 1616,  508},
                            {4580, 4402,  510, 1612,  512, 546,  510, 1614,  510, 1614,  510, 546,  512, 546,  512, 1612,  512, 546,  510, 546,  512, 1612,  512, 546,  510, 546,  512, 1614,  510, 1614,  510, 546,  510, 1612,  512, 546,  510, 546,  512, 546,  510, 1614,  510, 1614,  510, 1612,  512, 1612,  510, 1614,  510, 1614,  510, 1612,  512, 1614,  510, 546,  510, 546,  510, 548,  510, 546,  510, 546,  510, 1614,  510, 546,  512, 546,  510, 548,  510, 546,  512, 1612,  510, 548,  510, 546,  512, 546,  510, 1614,  510, 1614,  512, 1612,  510, 1614,  512, 546,  510, 1614,  510, 1614,  510, 5206,  4580, 4402,  510, 1614,  510, 546,  510, 1614,  512, 1612,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 1612,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  508, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  508, 548,  510, 548,  510, 548,  508, 548,  510, 548,  510, 1616,  508, 548,  508, 548,  508, 550,  508, 550,  508, 1616,  508, 548,  508, 548,  510, 548,  508, 1616,  508, 1616,  508, 1616,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508},
                            {4582, 4402,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 548,  510, 1614,  510, 1614,  512, 1612,  510, 1614,  510, 1616,  508, 1614,  510, 1614,  510, 1614,  510, 546,  510, 548,  510, 548,  510, 546,  510, 548,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 1614,  512, 1612,  512, 5204,  4580, 4404,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 548,  508, 1614,  510, 1614,  510, 548,  508, 1614,  510, 548,  510, 548,  510, 548,  508, 1614,  510, 1614,  510, 1614,  508, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1616,  508, 548,  508, 548,  508, 550,  508, 550,  508, 548,  508, 1616,  508, 548,  510, 1614,  508, 550,  508, 548,  510, 1614,  508, 550,  508, 550,  508, 550,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508},
                            {4580, 4402,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 1614,  510, 548,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 546,  510, 1614,  510, 548,  510, 548,  510, 548,  510, 1614,  510, 548,  510, 546,  510, 1614,  510, 546,  510, 1614,  510, 1614,  510, 5206,  4580, 4402,  510, 1614,  510, 548,  510, 1614,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 546,  510, 548,  510, 1614,  510, 548,  510, 548,  508, 1614,  510, 1614,  510, 548,  508, 1614,  510, 548,  510, 548,  510, 548,  508, 1614,  510, 1616,  508, 1616,  508, 1614,  510, 1614,  510, 1614,  510, 1614,  508, 1616,  508, 548,  510, 548,  508, 548,  508, 548,  508, 550,  508, 1614,  508, 550,  508, 1616,  508, 1616,  508, 548,  510, 1614,  508, 550,  508, 550,  508, 548,  508, 1616,  508, 550,  508, 550,  508, 1616,  508, 550,  508, 1616,  508, 1616,  508},
                         
                         
                         };
WiFiClient tcp;
PubSubClient mqtt(tcp);

const char* wifi_ssid = "OPPO A5";
const char* wifi_passwd = "12345678";
const char* mqtt_server = "qcbgkzv.mqtt.iot.gz.baidubce.com";
const char* mqtt_clientid = "led";
const char* mqtt_user = "qcbgkzv/led";
const char* mqtt_passwd = "v5d0hS0XED1lIYKv";
const char* topic_delta = "$baidu/iot/shadow/led/delta";
const char* topic_update = "$baidu/iot/shadow/led/update";

void mqtt_callback(const char* topic, byte* payload, unsigned int length)
{
  Serial.println(topic);
  if (String(topic) == topic_delta)
  {
    const size_t capacity = JSON_OBJECT_SIZE(2) + JSON_OBJECT_SIZE(3) + JSON_OBJECT_SIZE(5) + 100;
    DynamicJsonDocument doc(capacity);
    deserializeJson(doc, payload, length);

    int  ledswitch = doc["desired"]["ledswitch"];
    int  aircon = doc["desired"]["airpower"]; 
    int  airtemp = doc["desired"]["airtemp"];
    if (ledswitch==1)
    {
      Serial.println("qweqweqweqweqwe");
      digitalWrite(LED_BUILTIN, LOW);
    }
    else if(ledswitch==0);
    else{
      digitalWrite(LED_BUILTIN, HIGH);
    }
    if(aircon==1)
    {
       
       
        remote.sendRaw(poweron, 199, 38);  
        Serial.println("hello");
         remote.sendRaw(temp[0],199,38);
         num=0;
    }
    else if (aircon==0);
    else 
    { Serial.println("world");
      remote.sendRaw(poweroff, 199, 38);
     
    }
   if(airtemp==1)
    {
       
       
          
        Serial.println("jian");
        if(num>0&&num<=13)
        {
          num--;
           remote.sendRaw(temp[num], 199, 38); 
        }
    }
    else if (airtemp==0);
    else 
    { 
      Serial.println("add");
      if(num>=0&&num<13)
      {
        num++;
        remote.sendRaw(temp[num], 199, 38);
      }
      
      
    }
  }
}

void setup() {
  remote.begin();
  Serial.begin(115200);
  Serial.println();
  sensor.begin();
  pinMode(LED_BUILTIN, OUTPUT);
  digitalWrite(LED_BUILTIN, HIGH);

  WiFi.mode(WIFI_STA);
  WiFi.begin(wifi_ssid, wifi_passwd);
  while (!WiFi.isConnected())
  {
    delay(100);
  }
  Serial.println("WiFi is connected");

  mqtt.setServer(mqtt_server, 1883);
  mqtt.setCallback(mqtt_callback);
}

int prev = 0;

void loop() {
  if (!mqtt.connected())
  {
    mqtt.connect(mqtt_clientid, mqtt_user, mqtt_passwd);
    mqtt.subscribe(topic_delta, 1);
    Serial.println("Baidu IoT Hub connected");
  }
  mqtt.loop();
  if (millis() - prev > 30000) //30s上报一次状态
  {
    prev = millis();
    int temp = sensor.readTemperature();
    int humi = sensor.readHumidity();
    const size_t capacity = JSON_OBJECT_SIZE(1) + JSON_OBJECT_SIZE(2);
    DynamicJsonDocument doc(capacity);

    JsonObject reported = doc.createNestedObject("reported");
    reported["temperature"] = temp;
    reported["humidity"] = humi;
    

    String msg;
    serializeJson(doc, msg);
    Serial.println(msg);
    mqtt.publish(topic_update, msg.c_str());
  }
}
